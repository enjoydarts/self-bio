---
import { siteConfig } from '../data/siteConfig';

let commitHash = '';
let commitUrl = '';

try {
  const response = await fetch(`https://api.github.com/repos/${siteConfig.github.repo}/commits/${siteConfig.github.branch}`);
  const data = await response.json();

  if (data.sha) {
    commitHash = data.sha.substring(0, 7);
    commitUrl = data.html_url;
  }
} catch (error) {
  console.error('Failed to fetch commit hash:', error);
}

const currentYear = new Date().getFullYear();
---

<footer class="mt-20 pt-10 border-t border-gray-300 text-gray-500 text-[13px]">
  <div class="flex justify-between items-center max-mobile:flex-col max-mobile:gap-3">
    <p>&copy; {currentYear} {siteConfig.name}</p>
    {commitHash && (
      <div class="opacity-50 transition-opacity duration-200 hover:opacity-100">
        <a href={commitUrl} class="text-gray-500 no-underline text-[11px] transition-colors duration-200 hover:text-cyan" target="_blank" rel="noopener">
          <span>Version:</span> <span class="font-mono">{commitHash}</span>
        </a>
      </div>
    )}
  </div>
</footer>
