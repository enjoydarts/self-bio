---
interface BlogPost {
  title: string;
  link: string;
  pubDate: string;
}

let posts: BlogPost[] = [];

try {
  const response = await fetch('https://api.rss2json.com/v1/api.json?rss_url=https://enjoydarts.blog/feed');
  const data = await response.json();

  if (data.status === 'ok' && data.items) {
    posts = data.items.slice(0, 5).map((item: any) => ({
      title: item.title,
      link: item.link,
      pubDate: new Date(item.pubDate).toLocaleDateString('ja-JP', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
      }),
    }));
  }
} catch (error) {
  console.error('Failed to fetch blog posts:', error);
}
---

<section class="mb-[50px]">
  <h2 class="text-lg font-semibold text-white mb-5">Latest Blog Posts</h2>
  <div class="flex flex-col">
    {posts.length > 0 ? (
      posts.map((post) => (
        <a href={post.link} class="flex items-center justify-between py-4 no-underline text-gray-900 border-b border-gray-300 transition-all duration-200 hover:text-cyan group" target="_blank" rel="noopener">
          <div class="flex-1">
            <div class="text-[15px] font-medium mb-1 leading-[1.5]">{post.title}</div>
            <div class="text-[13px] text-gray-500">{post.pubDate}</div>
          </div>
          <svg class="w-5 h-5 flex-shrink-0 ml-3 transition-transform duration-200 group-hover:translate-x-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </a>
      ))
    ) : (
      <div class="p-5 text-center text-gray-500 text-sm">記事を読み込めませんでした。</div>
    )}
  </div>
</section>
